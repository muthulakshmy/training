<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" type="text/css" href="day5.css" />
  </head>
  <body>
    <main>
      <section class="form">
        <h2>Contact Form</h2>
        <div id="form">
          <form id="myForm">
            <label for="name">Name:</label>
            <input type="text" id="name" name="name" value="name" />
            <br /><br />

            <label for="email">E mail:</label>
            <input type="email" id="email" name="email" value="email" />
            <br /><br />
            <label for="age">Age:</label>
            <input type="number" id="age" name="age" value="age" />
            <br /><br />
            <label for="dob">dob:</label>
            <input type="date" id="dob" name="dob" value="dob" />
            <br /><br />
            <input type="submit" id="button" value="submit" />
          </form>
        </div>
      </section>

      <section class="table">
        <table id="table">
          <caption>
            Table
          </caption>
          <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Age</th>
            <th>Date of Birth</th>
            <th>Actions</th>
          </tr>
        </table>
      </section>
    </main>

    <script>
      let selectedRow = null;
      document
        .getElementById("myForm")
        .addEventListener("submit", function (event) {
          event.preventDefault();
          console.log("1");

          let name = document.getElementById("name").value;
          let email = document.getElementById("email").value;
          let age = document.getElementById("age").value;
          let dob = document.getElementById("dob").value;

          console.log(name, email, age, dob);
          if (selectedRow == null) {
            insertData(name, email, age, dob);
          } else {
            updateData(name, email, age, dob);
          }

          document.getElementById("myForm").reset();
        });

      function insertData(name, email, age, dob) {
        let table = document.getElementById("table");

        let row = table.insertRow(1);

        let cell1 = row.insertCell(0);
        cell1.innerHTML = name;
        let cell2 = row.insertCell(1);
        cell2.innerHTML = email;
        let cell3 = row.insertCell(2);
        cell3.innerHTML = age;
        let cell4 = row.insertCell(3);
        cell4.innerHTML = dob;

        let cell5 = row.insertCell(4);
        cell5.innerHTML =
          '<input type="button" value="Edit" onclick="edit(this)">' +
          " " +
          '<input type="button" value="Delete" onclick="deleteData(this)">';
      }

      function edit(btn) {
        let row = btn.parentNode.parentNode;

        selectedRow = row;

        console.log("row", btn);
        console.log("row", btn.parentNode);
        console.log("row", row);

        document.getElementById("name").value = row.cells[0].innerHTML;
        document.getElementById("email").value = row.cells[1].innerHTML;
        document.getElementById("age").value = row.cells[2].innerHTML;
        document.getElementById("dob").value = row.cells[3].innerHTML;

        console.log("name", name);

        let submitBtn = document.querySelector("input[type=submit]");
        submitBtn.value = "Update";
      }

      function updateData(name, email, dob) {
        selectedRow.cells[0].innerHTML = name;
        selectedRow.cells[1].innerHTML = email;
        selectedRow.cells[2].innerHTML = age;
        selectedRow.cells[3].innerHTML = dob;

        let submitBtn = document.querySelector("input[type=submit]");
        submitBtn.value = "Submit";

        selectedRow = null;
      }

      function deleteData(btn) {
        let row = btn.parentNode.parentNode;

        let confirmation = confirm("Are you sure you want to delete");

        if (confirmation) {
          row.parentNode.removeChild(row);
        }
      }
    </script>
  </body>
</html>
